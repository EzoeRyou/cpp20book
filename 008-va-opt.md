## `__VA_OPT__`

`__VA_OPT__`は可変引数マクロの中で使う識別子だ。

C99とC++11で追加された`__VA_ARGS__`によって、プリプロセッサーは可変引数マクロに対応した。

~~~c++
template < typename Types >
void f( Types && ... args ) ;

#define F( X, ... ) f( X, __VA_ARGS__ )

// f( 0, 1, 2, 3 )
F( 0, 1, 2, 3 ) ;
~~~

可変引数マクロはゼロ個のトークンに対応できない問題があった。

~~~c++
// エラー、文法上余計なカンマ
// f( 0, )
F( 0 ) ;
~~~

このようにゼロ個のトークン列を渡すと、余計なカンマが存在するためにエラーとなってしまう。

`__VA_OPT__`はこのような場合に、選択的にカンマに置換される識別子だ。

`__VA_OPT__(tokens)`は、可変引数マクロの置換リストの中に書くことができる。もし`__VA_ARGS__`がゼロ個のトークンである場合、空のトークンに置換される。そうでない場合、`tokens`に置換される。

~~~c~~
#define F( X, ... ) f( X __VA_OPT(,) __VA_ARGS__ )

// f( 0, 1, 2, 3 )
// __VA_OPT__(,)は,
// __VA_ARGS__は1,2,3
F( 0, 1, 2, 3 )
// f(0)
// __VA_OPT__(,)は空
// __VA_ARGS__は空
F( 0 ) 
~~~


これによって選択的にカンマのようなトークン列に置換させることができ、ゼロ個の引数に対応した可変引数マクロを作ることができる。
