## `[=]`による暗黙のthisのキャプチャーの廃止予定

C++17までは、ラムダ式のデフォルトキャプチャー`[=]`はthisポインターをキャプチャする。この挙動はC++20では廃止予定となった。C++20ではまだこの挙動に従うが、将来は廃止される予定だ。C++20からは、明示的に`[this]`を使う必要がある。

~~~cpp
struct S
{
    int member ;
    void f()
    {
        // C++17までは合法
        // C++20では廃止予定で非推奨
        [=}{ member ; } ;

        // C++20以降で合法
        // 意味はC++17までの上と同じ
        [=, this] { member ; } ;
    }
} ;
~~~

C++11で追加されたラムダ式のデフォルトキャプチャー`[=]`は、thisポインターをコピーキャプチャーする。thisポインターの参照する先のオブジェクトの値をコピーしているわけではない。コピーしているのはポインターであるので、メンバーへのアクセスはポインターを経由した関節アクセスになる。

この挙動は混乱の元であったので、C++14では明示的なキャプチャーである`[name = expr]`が追加された。C++17では`this`ポインターの参照先、すなわち`*this`をコピーキャプチャーする専用のキャプチャーである`[*this]`が追加された。C++20では将来廃止するために、デフォルトキャプチャー`[=]`ではthisポインターをコピーキャプチャーする挙動を廃止予定とした。
